<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/page/2/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 6.1.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-php-array" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/10/25/php-array/" class="article-date">
  <time class="dt-published" datetime="2020-10-25T11:54:17.000Z" itemprop="datePublished">2020-10-25</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/PHP/">PHP</a>►<a class="article-category-link" href="/categories/PHP%E6%BA%90%E7%A0%81/">PHP源码</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/10/25/php-array/">PHP数组的存储</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>PHP数组是PHP最复杂的数据结构，没有之一，如果能把数据彻底搞透，那么其他的数据结构也能理解的差不多了。</p>
<h4 id="数据结构"><a href="#数据结构" class="headerlink" title="数据结构"></a>数据结构</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">Bucket</span> &#123;</span></span><br><span class="line">    zval              val;</span><br><span class="line">    zend_ulong        h;                <span class="comment">/* hash value (or numeric index)   */</span></span><br><span class="line">    zend_string      *key;              <span class="comment">/* string key or NULL for numerics */</span></span><br><span class="line">&#125; Bucket;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">zend_array</span> <span class="title">HashTable</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> _<span class="title">zend_array</span> &#123;</span></span><br><span class="line">    zend_refcounted_h gc;</span><br><span class="line">    <span class="class"><span class="keyword">union</span> &#123;</span></span><br><span class="line">        <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">            ZEND_ENDIAN_LOHI_4(</span><br><span class="line">                zend_uchar    flags,</span><br><span class="line">                zend_uchar    nApplyCount,</span><br><span class="line">                zend_uchar    nIteratorsCount,</span><br><span class="line">                zend_uchar    consistency)</span><br><span class="line">        &#125; v;</span><br><span class="line">        <span class="type">uint32_t</span> flags;</span><br><span class="line">    &#125; u;</span><br><span class="line">    <span class="type">uint32_t</span>          nTableMask; <span class="comment">// 中间映射表，用来映射在arData的存储位置</span></span><br><span class="line">    Bucket           *arData; <span class="comment">// 元素的存储数据结构，默认指向第一个元素</span></span><br><span class="line">    <span class="type">uint32_t</span>          nNumUsed; <span class="comment">// arData使用的个数</span></span><br><span class="line">    <span class="type">uint32_t</span>          nNumOfElements; <span class="comment">// 数组的个数</span></span><br><span class="line">    <span class="type">uint32_t</span>          nTableSize; <span class="comment">// 数组的大小</span></span><br><span class="line">    <span class="type">uint32_t</span>          nInternalPointer;</span><br><span class="line">    zend_long         nNextFreeElement;</span><br><span class="line">    <span class="type">dtor_func_t</span>       pDestructor;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h4 id="数组的初始化"><a href="#数组的初始化" class="headerlink" title="数组的初始化"></a>数组的初始化</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">ZEND_API <span class="type">void</span> ZEND_FASTCALL _zend_hash_init(HashTable *ht, <span class="type">uint32_t</span> nSize, <span class="type">dtor_func_t</span> pDestructor, zend_bool persistent ZEND_FILE_LINE_DC)</span><br><span class="line">&#123;</span><br><span class="line">    GC_REFCOUNT(ht) = <span class="number">1</span>;</span><br><span class="line">    GC_TYPE_INFO(ht) = IS_ARRAY;</span><br><span class="line">    ht-&gt;u.flags = (persistent ? HASH_FLAG_PERSISTENT : <span class="number">0</span>)  HASH_FLAG_APPLY_PROTECTION  HASH_FLAG_STATIC_KEYS;</span><br><span class="line">    ht-&gt;nTableMask = HT_MIN_MASK;</span><br><span class="line">    HT_SET_DATA_ADDR(ht, &amp;uninitialized_bucket);</span><br><span class="line">    ht-&gt;nNumUsed = <span class="number">0</span>;</span><br><span class="line">    ht-&gt;nNumOfElements = <span class="number">0</span>;</span><br><span class="line">    ht-&gt;nInternalPointer = HT_INVALID_IDX;</span><br><span class="line">    ht-&gt;nNextFreeElement = <span class="number">0</span>;</span><br><span class="line">    ht-&gt;pDestructor = pDestructor;</span><br><span class="line">    ht-&gt;nTableSize = zend_hash_check_size(nSize);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> zend_always_inline <span class="type">void</span> <span class="title function_">zend_hash_real_init_ex</span><span class="params">(HashTable *ht, <span class="type">int</span> packed)</span></span><br><span class="line">&#123;</span><br><span class="line">    HT_ASSERT(GC_REFCOUNT(ht) == <span class="number">1</span>);</span><br><span class="line">    ZEND_ASSERT(!((ht)-&gt;u.flags &amp; HASH_FLAG_INITIALIZED));</span><br><span class="line">    <span class="keyword">if</span> (packed) &#123;</span><br><span class="line">        HT_SET_DATA_ADDR(ht, pemalloc(HT_SIZE(ht), (ht)-&gt;u.flags &amp; HASH_FLAG_PERSISTENT));</span><br><span class="line">        (ht)-&gt;u.flags = HASH_FLAG_INITIALIZED  HASH_FLAG_PACKED;</span><br><span class="line">        HT_HASH_RESET_PACKED(ht);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        (ht)-&gt;nTableMask = -(ht)-&gt;nTableSize;</span><br><span class="line">        HT_SET_DATA_ADDR(ht, pemalloc(HT_SIZE(ht), (ht)-&gt;u.flags &amp; HASH_FLAG_PERSISTENT));</span><br><span class="line">        (ht)-&gt;u.flags = HASH_FLAG_INITIALIZED;</span><br><span class="line">        <span class="keyword">if</span> (EXPECTED(ht-&gt;nTableMask == (<span class="type">uint32_t</span>)<span class="number">-8</span>)) &#123;</span><br><span class="line">            Bucket *arData = ht-&gt;arData;</span><br><span class="line"></span><br><span class="line">            HT_HASH_EX(arData, <span class="number">-8</span>) = <span class="number">-1</span>;</span><br><span class="line">            HT_HASH_EX(arData, <span class="number">-7</span>) = <span class="number">-1</span>;</span><br><span class="line">            HT_HASH_EX(arData, <span class="number">-6</span>) = <span class="number">-1</span>;</span><br><span class="line">            HT_HASH_EX(arData, <span class="number">-5</span>) = <span class="number">-1</span>;</span><br><span class="line">            HT_HASH_EX(arData, <span class="number">-4</span>) = <span class="number">-1</span>;</span><br><span class="line">            HT_HASH_EX(arData, <span class="number">-3</span>) = <span class="number">-1</span>;</span><br><span class="line">            HT_HASH_EX(arData, <span class="number">-2</span>) = <span class="number">-1</span>;</span><br><span class="line">            HT_HASH_EX(arData, <span class="number">-1</span>) = <span class="number">-1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            HT_HASH_RESET(ht);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在初始化之前，会先调用_zend_hash_init进行一些简单的初始化操作，但是这部分做的事情比较少，只是初始化了nTableSize&#x3D;8，arData的内存大小是根据这个值确定的，它的大小是8的幂次方，最小为8；</p>
<p>其他的初始化操作，是通过zend_hash_real_init_ex函数进行的：</p>
<ul>
<li>首先，将u.flags设置为<code>初始化</code>的状态</li>
<li>将映射关系nTableMask设置为nTableSize大小的相反数</li>
<li>申请地址空间，设备的地址空间大小是nTableMask和nTableSize的两个地址空间大小</li>
<li>设置arData的每个元素的值为-1</li>
</ul>
<h4 id="数组的赋值-zend-hash-add-or-update-i"><a href="#数组的赋值-zend-hash-add-or-update-i" class="headerlink" title="数组的赋值_zend_hash_add_or_update_i"></a>数组的赋值_zend_hash_add_or_update_i</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> zend_always_inline zval *_zend_hash_add_or_update_i(HashTable *ht, zend_string *key, zval *pData, <span class="type">uint32_t</span> flag ZEND_FILE_LINE_DC)</span><br><span class="line">&#123;</span><br><span class="line">    zend_ulong h;</span><br><span class="line">    <span class="type">uint32_t</span> nIndex;</span><br><span class="line">    <span class="type">uint32_t</span> idx;</span><br><span class="line">    Bucket *p;</span><br><span class="line"></span><br><span class="line">    IS_CONSISTENT(ht);</span><br><span class="line">    HT_ASSERT(GC_REFCOUNT(ht) == <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (UNEXPECTED(!(ht-&gt;u.flags &amp; HASH_FLAG_INITIALIZED))) &#123;</span><br><span class="line">        CHECK_INIT(ht, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">goto</span> add_to_hash;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (ht-&gt;u.flags &amp; HASH_FLAG_PACKED) &#123;</span><br><span class="line">        zend_hash_packed_to_hash(ht);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> ((flag &amp; HASH_ADD_NEW) == <span class="number">0</span>) &#123;</span><br><span class="line">        p = zend_hash_find_bucket(ht, key);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (p) &#123;</span><br><span class="line">            zval *data;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (flag &amp; HASH_ADD) &#123;</span><br><span class="line">                <span class="keyword">if</span> (!(flag &amp; HASH_UPDATE_INDIRECT)) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                ZEND_ASSERT(&amp;p-&gt;val != pData);</span><br><span class="line">                data = &amp;p-&gt;val;</span><br><span class="line">                <span class="keyword">if</span> (Z_TYPE_P(data) == IS_INDIRECT) &#123;</span><br><span class="line">                    data = Z_INDIRECT_P(data);</span><br><span class="line">                    <span class="keyword">if</span> (Z_TYPE_P(data) != IS_UNDEF) &#123;</span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                ZEND_ASSERT(&amp;p-&gt;val != pData);</span><br><span class="line">                data = &amp;p-&gt;val;</span><br><span class="line">                <span class="keyword">if</span> ((flag &amp; HASH_UPDATE_INDIRECT) &amp;&amp; Z_TYPE_P(data) == IS_INDIRECT) &#123;</span><br><span class="line">                    data = Z_INDIRECT_P(data);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (ht-&gt;pDestructor) &#123;</span><br><span class="line">                ht-&gt;pDestructor(data);</span><br><span class="line">            &#125;</span><br><span class="line">            ZVAL_COPY_VALUE(data, pData);</span><br><span class="line">            <span class="keyword">return</span> data;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ZEND_HASH_IF_FULL_DO_RESIZE(ht);        <span class="comment">/* If the Hash table is full, resize it */</span></span><br><span class="line"></span><br><span class="line">add_to_hash:</span><br><span class="line">    idx = ht-&gt;nNumUsed++;</span><br><span class="line">    ht-&gt;nNumOfElements++;</span><br><span class="line">    <span class="keyword">if</span> (ht-&gt;nInternalPointer == HT_INVALID_IDX) &#123;</span><br><span class="line">        ht-&gt;nInternalPointer = idx;</span><br><span class="line">    &#125;</span><br><span class="line">    zend_hash_iterators_update(ht, HT_INVALID_IDX, idx);</span><br><span class="line">    p = ht-&gt;arData + idx;</span><br><span class="line">    p-&gt;key = key;</span><br><span class="line">    <span class="keyword">if</span> (!ZSTR_IS_INTERNED(key)) &#123;</span><br><span class="line">        zend_string_addref(key);</span><br><span class="line">        ht-&gt;u.flags &amp;= ~HASH_FLAG_STATIC_KEYS;</span><br><span class="line">        zend_string_hash_val(key);</span><br><span class="line">    &#125;</span><br><span class="line">    p-&gt;h = h = ZSTR_H(key);</span><br><span class="line">    ZVAL_COPY_VALUE(&amp;p-&gt;val, pData);</span><br><span class="line">    nIndex = h  ht-&gt;nTableMask;</span><br><span class="line">    Z_NEXT(p-&gt;val) = HT_HASH(ht, nIndex);</span><br><span class="line">    HT_HASH(ht, nIndex) = HT_IDX_TO_HASH(idx);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &amp;p-&gt;val;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>首先，在赋值之前，会先判断数组是否已经被初始化过，如果初始化那么就进行赋值的操作</li>
<li>赋值的时候，会把nNumUsed进行累加，然后得到arData的位置</li>
<li>将赋值的bucket设置hash code和key等成员变量</li>
<li>根据hash code，计算出在nTableMask对应的位置为nIndex</li>
<li>将arData的位置，存储到nTableMask对应的nIndex的值上面</li>
</ul>
<p><img src="/uploads/2020/01/%E7%BB%98%E5%9B%BE1.png"></p>
<p>本文链接: <a target="_blank" rel="noopener" href="https://feilong.tech/2020/10/25/php-array">https://feilong.tech/2020/10/25/php-array</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2020/10/25/php-array/" data-id="cl0oi8mh30055417tepvb853s" data-title="PHP数组的存储" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/PHP/" rel="tag">PHP</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/PHP7/" rel="tag">PHP7</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/PHP%E6%BA%90%E7%A0%81/" rel="tag">PHP源码</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-php-parse-post" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/12/20/php-parse-post/" class="article-date">
  <time class="dt-published" datetime="2019-12-20T13:39:55.000Z" itemprop="datePublished">2019-12-20</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/PHP/">PHP</a>►<a class="article-category-link" href="/categories/PHP%E6%BA%90%E7%A0%81/">PHP源码</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/12/20/php-parse-post/">PHP $_POST接收大量form表单数据缺失探究</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h3><p>最近遇到一个线上问题，服务A，调用服务B的接口，发现服务B报“xxx参数不存在”，但是通过服务A的请求日志发现，是有参数”xxx”。然后翻了一下服务B的日志，发现没有参数”xxx”，而且以外发现，接收的数据，比传输的数据少一部分！</p>
<h3 id="黑人问号？？"><a href="#黑人问号？？" class="headerlink" title="黑人问号？？"></a>黑人问号？？</h3><p>最初怀疑是A传输写数据的原因，随后在请求前，打印了内容，<code>发现是完整的！！！好玄幻！！！</code></p>
<p>然后在B打印了 file_get_contents(“php:&#x2F;&#x2F;input”)，$_POST，发前者的内容是完整的，后者的内容要偏少，所以A传输的数据应该没有问题！！</p>
<p>那问题到底出现在了哪里？？？</p>
<h3 id="探究原因"><a href="#探究原因" class="headerlink" title="探究原因"></a>探究原因</h3><p>为了查明下原因，我怀疑是和代码有关系，所以索性，把数据搞到postman，通过postman再尝试下</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#接收端代码</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">file_put_contents</span>(<span class="string">&quot;txt&quot;</span>, <span class="title function_ invoke__">json_encode</span>(<span class="variable">$_POST</span>));</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 启动phpserver服务</span></span><br><span class="line">$ php7 -S 127.0.0.1:9090</span><br><span class="line">PHP 7.1.2RC1 Development Server started at Fri Dec 20 13:40:31 2019</span><br><span class="line">Listening on http://127.0.0.1:9090</span><br><span class="line">Document root is /Users/sf</span><br><span class="line">Press Ctrl-C to quit.</span><br><span class="line">[Fri Dec 20 13:40:38 2019] PHP Warning:  Unknown: Input variables exceeded 1000. To increase the <span class="built_in">limit</span> change max_input_vars <span class="keyword">in</span> php.ini. <span class="keyword">in</span> Unknown on line 0</span><br><span class="line">[Fri Dec 20 13:40:38 2019] 127.0.0.1:59719 [200]: /index.php</span><br></pre></td></tr></table></figure>

<p>意外发现，控制台输出了一条warning信息</p>
<p><code>[Fri Dec 20 13:40:38 2019] PHP Warning: Unknown: Input variables exceeded 1000. To increase the limit change max_input_vars in php.ini. in Unknown on line 0</code></p>
<p>这条信息，仿佛是一棵救命稻草一样，我根据提示信息，查询了一下官方文档</p>
<blockquote>
<p>max_input_vars integer 接受多少 输入的变量（限制分别应用于 $_GET、$_POST 和 $_COOKIE 超全局变量） 指令的使用减轻了以哈希碰撞来进行拒绝服务攻击的可能性。 如有超过指令指定数量的输入变量，将会导致 E_WARNING 的产生， 更多的输入变量将会从请求中截断。</p>
</blockquote>
<p>原来，PHP处于安全考虑，会在form表单提交的时候，会限制参数解析的个数，如果超过规定的个数，就会出现截断的问题，默认限制是1000个。而我提交的数据，早就超过1000个了。这应该就是$_POST要比php:&#x2F;&#x2F;input里面数据少的原因了。</p>
<h3 id="截取的策略"><a href="#截取的策略" class="headerlink" title="截取的策略"></a>截取的策略</h3><p>原因找到了，这就萌生了另外一个问题，$_POST虽然被截断了，但是为什么打印出来的信息，还是一个完整的数组的结构？截断的策略是什么样的？这恐怕需要分析一下PHP的源码了！</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#php_variables.c</span></span><br><span class="line"></span><br><span class="line">static inline int add_post_vars(zval *arr, post_var_data_t *vars, zend_bool eof)</span><br><span class="line">&#123;</span><br><span class="line">    uint64_t max_vars = PG(max_input_vars);</span><br><span class="line"></span><br><span class="line">    vars-&gt;ptr = ZSTR_VAL(vars-&gt;str.s);</span><br><span class="line">    vars-&gt;end = ZSTR_VAL(vars-&gt;str.s) + ZSTR_LEN(vars-&gt;str.s);</span><br><span class="line">    <span class="keyword">while</span> (add_post_var(arr, vars, eof)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (++vars-&gt;cnt &gt; max_vars) &#123;</span><br><span class="line">            php_error_docref(NULL, E_WARNING,</span><br><span class="line">                    <span class="string">&quot;Input variables exceeded %&quot;</span> PRIu64 <span class="string">&quot;. &quot;</span></span><br><span class="line">                    <span class="string">&quot;To increase the limit change max_input_vars in php.ini.&quot;</span>,</span><br><span class="line">                    max_vars);</span><br><span class="line">            <span class="built_in">return</span> FAILURE;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!eof) &#123;</span><br><span class="line">        memmove(ZSTR_VAL(vars-&gt;str.s), vars-&gt;ptr, ZSTR_LEN(vars-&gt;str.s) = vars-&gt;end - vars-&gt;ptr);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">return</span> SUCCESS;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>PHP会首先初始化解析数据的指针，然后通过while的循环，逐次对post的数据进行解析，然后设置vars-&gt;ptr的值，用来记录当前解析的位置，并对解析变量的个数进行统计，当<code>++vars-&gt;cnt &gt; max_vars</code> 的时候，会终止解析，但是解析的时候，是按照key value结对解析，所以截断后，$_POST里面也是标准的数组结构。</p>
<p><code>add_post_var</code>是具体的解析策略， 以<code>name=feilong&amp;sex=man</code>为例</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">static zend_bool add_post_var(zval *arr, post_var_data_t *var, zend_bool eof)</span><br><span class="line">&#123;</span><br><span class="line">    char *ksep, *vsep, *val;</span><br><span class="line">    size_t klen, vlen;</span><br><span class="line">    size_t new_vlen;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (var-&gt;ptr &gt;= var-&gt;end) &#123;</span><br><span class="line">        <span class="built_in">return</span> 0;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    vsep = memchr(var-&gt;ptr, <span class="string">&#x27;&amp;&#x27;</span>, var-&gt;end - var-&gt;ptr);</span><br><span class="line">    <span class="keyword">if</span> (!vsep) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!eof) &#123;</span><br><span class="line">            <span class="built_in">return</span> 0;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            vsep = var-&gt;end;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ksep = memchr(var-&gt;ptr, <span class="string">&#x27;=&#x27;</span>, vsep - var-&gt;ptr);</span><br><span class="line">    <span class="keyword">if</span> (ksep) &#123;</span><br><span class="line">        *ksep = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">        /* <span class="string">&quot;foo=bar&amp;&quot;</span> or <span class="string">&quot;foo=&amp;&quot;</span> */</span><br><span class="line">        klen = ksep - var-&gt;ptr;</span><br><span class="line">        vlen = vsep - ++ksep;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        ksep = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        /* <span class="string">&quot;foo&amp;&quot;</span> */</span><br><span class="line">        klen = vsep - var-&gt;ptr;</span><br><span class="line">        vlen = 0;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    php_url_decode(var-&gt;ptr, klen);</span><br><span class="line"></span><br><span class="line">    val = estrndup(ksep, vlen);</span><br><span class="line">    <span class="keyword">if</span> (vlen) &#123;</span><br><span class="line">        vlen = php_url_decode(val, vlen);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (sapi_module.input_filter(PARSE_POST, var-&gt;ptr, &amp;val, vlen, &amp;new_vlen)) &#123;</span><br><span class="line">        php_register_variable_safe(var-&gt;ptr, val, new_vlen, arr);</span><br><span class="line">    &#125;</span><br><span class="line">    efree(val);</span><br><span class="line"></span><br><span class="line">    var-&gt;ptr = vsep + (vsep != var-&gt;end);</span><br><span class="line">    <span class="built_in">return</span> 1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>首先，定位到<code>name=feilong</code>，然后进行拆解，将name赋值var-&gt;ptr，将feilong赋值给val变量，然后通过<code>php_register_variable_safe</code>函数，进行变量的注册。</p>
<p>不过在注册之前，会先进行一次过滤的操作。</p>
<blockquote>
<p>filter_input filter_input — 通过名称获取特定的外部变量，并且可以通过过滤器处理它 filter_input ( int $type , string $variable_name [, int $filter &#x3D; FILTER_DEFAULT [, mixed $options ]] ) : mixed type INPUT_GET, INPUT_POST, INPUT_COOKIE, INPUT_SERVER或 INPUT_ENV之一。 …..</p>
</blockquote>
<p>从源码上来看，这里过滤的类型是<code>INPUT_POST</code>。</p>
<p>PHP就是通过这样一层层的循环解析，直到解析的变量个数超过限制或者解析结束，把原有的form表单的数据，解析成$_POST数组。</p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>回到文章的标题，其实这次问题出现的原因，并不是在于”传输”，而在于解析数据，处于安全考虑，PHP做了一层限制，防止黑客传输过多的数据，导致用户被DDoS攻击。</p>
<p>本文链接: <a target="_blank" rel="noopener" href="https://feilong.tech/2019/12/20/php-parse-post">https://feilong.tech/2019/12/20/php-parse-post</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2019/12/20/php-parse-post/" data-id="cl0oi8mhi005w417teb696rpr" data-title="PHP $_POST接收大量form表单数据缺失探究" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/PHP/" rel="tag">PHP</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/PHP7/" rel="tag">PHP7</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/http/" rel="tag">http</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-redis-hyperloglog" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/11/21/redis-hyperloglog/" class="article-date">
  <time class="dt-published" datetime="2019-11-21T14:59:54.000Z" itemprop="datePublished">2019-11-21</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Docker/">Docker</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/11/21/redis-hyperloglog/">Redis数据类型之HyperLogLog</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>Redis相对于memcache的优势之一就是支持丰富的数据结构，比如Hash、List、Set、Zset等。除了这些以外，redis还支持HyperLogLog</p>
<h3 id="HyperLogLog"><a href="#HyperLogLog" class="headerlink" title="HyperLogLog"></a>HyperLogLog</h3><p>假如有个需求，需要统计UV情况，我们的思路是什么？</p>
<ul>
<li>Hash: 我们可以使用Hash的结构，使用用户的ip当做元素的key，最后使用<code>HLEN</code>统计下个数</li>
<li>Set: Set是无序唯一的，同样可以使用用户的IP作为key，最后使用<code>SCARD</code>统计个数</li>
</ul>
<p>没错，这两种都可以实现需求，但是对内存的占用是惊人的，如果是上千万的UV，那么会占用大量的内存。那么有没有<code>物美价廉</code>的方式呢？那就是HyperLogLog。</p>
<h3 id="HyperLogLog的优势和劣势"><a href="#HyperLogLog的优势和劣势" class="headerlink" title="HyperLogLog的优势和劣势"></a>HyperLogLog的优势和劣势</h3><p>HyperLogLog只会占用<code>12KB</code>左右的存储空间，这个既是优势，优势劣势，因为如果数量比较小，这个<code>12KB</code>左右的空间是非常不划算的。</p>
<p>但是redis也对HyperLogLog进行了优化，在计数比较小的时候，采用稀疏矩阵存储，占用的空间比较小，只有当超过了某个阈值，才会一次性变得稠密，才会占用<code>12KB</code>.</p>
<p>HyperLogLog的劣势就是会出现统计的误差，并不能精确的进行个数统计.</p>
<h3 id="对比情况"><a href="#对比情况" class="headerlink" title="对比情况"></a>对比情况</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##伪代码</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$redisObj</span> = <span class="keyword">new</span> <span class="title class_">Redis</span>();</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">add2HyperLogLog</span>();</span><br><span class="line"><span class="title function_ invoke__">add2Hash</span>();</span><br><span class="line"><span class="title function_ invoke__">add2Set</span>();</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add2HyperLogLog</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$redisObj</span>;</span><br><span class="line">    <span class="variable">$connect</span> = <span class="variable">$redisObj</span>::<span class="title function_ invoke__">getConn</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">100000</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="variable">$user</span>[<span class="string">&quot;user_name_&quot;</span>.<span class="variable">$i</span>] = <span class="string">&quot;user_&quot;</span> . <span class="variable">$i</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$connect</span>-&gt;<span class="title function_ invoke__">pfAdd</span>(<span class="string">&quot;user_by_hyper_log_log&quot;</span>, <span class="variable">$user</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add2Hash</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$redisObj</span>;</span><br><span class="line">    <span class="variable">$redisObj</span> = <span class="keyword">new</span> <span class="title class_">\Lta\Redis</span>();</span><br><span class="line">    <span class="variable">$connect</span> = <span class="variable">$redisObj</span>::<span class="title function_ invoke__">getConn</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">100000</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="variable">$connect</span>-&gt;<span class="title function_ invoke__">sAdd</span>(<span class="string">&quot;user_by_set&quot;</span>, <span class="string">&quot;user_&quot;</span> . <span class="variable">$i</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add2Set</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$redisObj</span>;</span><br><span class="line">    <span class="variable">$redisObj</span> = <span class="keyword">new</span> <span class="title class_">\Lta\Redis</span>();</span><br><span class="line">    <span class="variable">$connect</span> = <span class="variable">$redisObj</span>::<span class="title function_ invoke__">getConn</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">100000</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="variable">$connect</span>-&gt;<span class="title function_ invoke__">hSet</span>(<span class="string">&quot;user_by_hash&quot;</span>, <span class="string">&quot;user_name_&quot;</span>.<span class="variable">$i</span>,<span class="string">&quot;user_&quot;</span> . <span class="variable">$i</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">10.188.40.78:6379&gt; DEBUG OBJECT user_by_hash</span><br><span class="line">Value at:0x7fc170333f10 refcount:1 encoding:hashtable serializedlength:2677785 lru:14064726 lru_seconds_idle:147</span><br><span class="line">10.188.40.78:6379&gt; DEBUG OBJECT user_by_hyper_log_log</span><br><span class="line">Value at:0x7fc1700a6000 refcount:1 encoding:raw serializedlength:10592 lru:14064728 lru_seconds_idle:150</span><br><span class="line">10.188.40.78:6379&gt; DEBUG OBJECT user_by_set</span><br><span class="line">Value at:0x7fc1700a6010 refcount:1 encoding:hashtable serializedlength:1088895 lru:14064734 lru_seconds_idle:150</span><br><span class="line"></span><br><span class="line">10.188.40.78:6379&gt; PFCOUNT user_by_hyper_log_log</span><br><span class="line">(<span class="built_in">integer</span>) 99839</span><br><span class="line">10.188.40.78:6379&gt; SCARD user_by_set</span><br><span class="line">(<span class="built_in">integer</span>) 100000</span><br><span class="line">10.188.40.78:6379&gt; HLEN user_by_hash</span><br><span class="line">(<span class="built_in">integer</span>) 100000</span><br></pre></td></tr></table></figure>

<p>键名</p>
<p>长度</p>
<p>元素个数</p>
<p>user_by_hash</p>
<p>2677785</p>
<p>100000</p>
<p>user_by_hyper_log_log</p>
<p>10592</p>
<p>99839</p>
<p>user_by_set</p>
<p>1088895</p>
<p>100000</p>
<p>可以看到，使用user_by_hyper_log_log的存储，长度要小很多，但是统计的元素格式是不完整的，误差率是<code>0.161%</code>，对于统计UV来说，是可以接受的。</p>
<h3 id="使用rdbtools"><a href="#使用rdbtools" class="headerlink" title="使用rdbtools"></a>使用rdbtools</h3><p>但是serializedlength并不是真实的占用空间，并且在存储的时候，可能会进行序列化，要想查看真实的空间，需要使用另外的工具</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">$ pip install rdbtools</span><br><span class="line">Successfully built rdbtools</span><br><span class="line">Installing collected packages: rdbtools</span><br><span class="line">Successfully installed rdbtools-0.1.14</span><br><span class="line"></span><br><span class="line">$ redis-memory-for-key -s 10.188.40.78 user_by_hyper_log_log</span><br><span class="line">Key             user_by_hyper_log_log</span><br><span class="line">Bytes               14400</span><br><span class="line">Type                string</span><br><span class="line">$ redis-memory-for-key -s 10.188.40.78 user_by_hash</span><br><span class="line">Key             user_by_hash</span><br><span class="line">Bytes               7892932.0</span><br><span class="line">Type                <span class="built_in">hash</span></span><br><span class="line">Encoding            hashtable</span><br><span class="line">Number of Elements      100000</span><br><span class="line">Length of Largest Element   15</span><br><span class="line">$ redis-memory-for-key -s 10.188.40.78 user_by_set</span><br><span class="line">Key             user_by_set</span><br><span class="line">Bytes               5572932.0</span><br><span class="line">Type                <span class="built_in">set</span></span><br><span class="line">Encoding            hashtable</span><br><span class="line">Number of Elements      100000</span><br><span class="line">Length of Largest Element   10</span><br></pre></td></tr></table></figure>

<p>这个对比结果就很明显了，Hash占用的空间是HyperLogLog的548倍，Set占用的空间是HyperLogLog的387倍！</p>
<p>换算下占用的HyperLogLog的占用空间，大概是<code>14KB</code></p>
<h3 id="使用场景"><a href="#使用场景" class="headerlink" title="使用场景"></a>使用场景</h3><p>前面有说道，HyperLogLog是存在误差的，一般是一些对可接受小误差的统计，比如：</p>
<ul>
<li>统计注册 IP 数</li>
<li>统计每日访问 IP 数</li>
<li>统计页面实时 UV 数</li>
<li>统计在线用户数</li>
<li>统计用户每天搜索不同词条的个数</li>
</ul>
<h3 id="参考文献："><a href="#参考文献：" class="headerlink" title="参考文献："></a>参考文献：</h3><ul>
<li>《Redis深度历险》–钱文品</li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/maoyuanming0806/article/details/81814610">Redis：HyperLogLog使用与应用场景</a></li>
</ul>
<p>本文链接： <a target="_blank" rel="noopener" href="https://feilong.tech/2019/11/21/redis-hyperloglog">https://feilong.tech/2019/11/21/redis-hyperloglog</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2019/11/21/redis-hyperloglog/" data-id="cl0oi8mia007j417tg3o86238" data-title="Redis数据类型之HyperLogLog" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/HyperLogLog/" rel="tag">HyperLogLog</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Redis/" rel="tag">Redis</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%BB%9F%E8%AE%A1/" rel="tag">统计</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-make-php-error" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/11/11/make-php-error/" class="article-date">
  <time class="dt-published" datetime="2019-11-11T08:04:13.000Z" itemprop="datePublished">2019-11-11</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/PHP/">PHP</a>►<a class="article-category-link" href="/categories/PHP%E6%BA%90%E7%A0%81/">PHP源码</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/11/11/make-php-error/">mac 由于libiconv导致编译PHP7 ld: symbol(s) not found for architecture x86_64错误</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>从源码手动编译 PHP 时出现如下错误：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">Undefined symbols <span class="keyword">for</span> architecture x86_64:</span><br><span class="line">  <span class="string">&quot;_libiconv&quot;</span>, referenced from:</span><br><span class="line">      _php_iconv_string <span class="keyword">in</span> iconv.o</span><br><span class="line">      __php_iconv_strlen <span class="keyword">in</span> iconv.o</span><br><span class="line">      __php_iconv_substr <span class="keyword">in</span> iconv.o</span><br><span class="line">      __php_iconv_strpos <span class="keyword">in</span> iconv.o</span><br><span class="line">      __php_iconv_mime_encode <span class="keyword">in</span> iconv.o</span><br><span class="line">      __php_iconv_appendl <span class="keyword">in</span> iconv.o</span><br><span class="line">      _php_iconv_stream_filter_append_bucket <span class="keyword">in</span> iconv.o</span><br><span class="line">      ...</span><br><span class="line">  <span class="string">&quot;_libiconv_close&quot;</span>, referenced from:</span><br><span class="line">      _php_iconv_string <span class="keyword">in</span> iconv.o</span><br><span class="line">      __php_iconv_strlen <span class="keyword">in</span> iconv.o</span><br><span class="line">      __php_iconv_substr <span class="keyword">in</span> iconv.o</span><br><span class="line">      __php_iconv_strpos <span class="keyword">in</span> iconv.o</span><br><span class="line">      __php_iconv_mime_encode <span class="keyword">in</span> iconv.o</span><br><span class="line">      __php_iconv_mime_decode <span class="keyword">in</span> iconv.o</span><br><span class="line">      _php_iconv_stream_filter_dtor <span class="keyword">in</span> iconv.o</span><br><span class="line">      ...</span><br><span class="line">  <span class="string">&quot;_libiconv_open&quot;</span>, referenced from:</span><br><span class="line">      _php_iconv_string <span class="keyword">in</span> iconv.o</span><br><span class="line">      __php_iconv_strlen <span class="keyword">in</span> iconv.o</span><br><span class="line">      __php_iconv_substr <span class="keyword">in</span> iconv.o</span><br><span class="line">      __php_iconv_strpos <span class="keyword">in</span> iconv.o</span><br><span class="line">      __php_iconv_mime_encode <span class="keyword">in</span> iconv.o</span><br><span class="line">      __php_iconv_mime_decode <span class="keyword">in</span> iconv.o</span><br><span class="line">      _php_iconv_stream_filter_ctor <span class="keyword">in</span> iconv.o</span><br><span class="line">      ...</span><br><span class="line">ld: symbol(s) not found <span class="keyword">for</span> architecture x86_64</span><br><span class="line">clang: error: linker <span class="built_in">command</span> failed with <span class="built_in">exit</span> code 1 (use -v to see invocation)</span><br><span class="line">make: *** [sapi/cli/php] Error 1</span><br></pre></td></tr></table></figure>

<p>这个是因为我在编译的时候设置–with-iconv的路径，猜测应该是iconv的问题。 参照文章 compile php with openssl on mac osx error找到了一些灵感 MakeFile 里面找到类似下面这一行：</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EXTRA_LIBS = -lresolv -liconv -liconv -lm -lxml2 -lz -licucore -lm -lxml2 -lz -licucore -lm -lxml2 -lz -licucore -lm -lxml2 -lz -licucore -lm -lxml2 -lz -licucore -lm -lxml2 -lz -licucore -lm</span><br></pre></td></tr></table></figure>

<p>删除所有 -liconv 在后面填写 libiconv.dylib和libcharset.dylib的路径 如果你是用homebrew安卓的libiconv那么路径就是 &#x2F;usr&#x2F;local&#x2F;opt&#x2F;libiconv&#x2F;lib 附上我修改后的 MakeFile EXTRA_LIBS 那一行：</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EXTRA_LIBS = -lresolv -lm -lxml2 -lz -licucore -lm -lxml2 -lz -licucore -lm -lxml2 -lz -licucore -lm -lxml2 -lz -licucore -lm -lxml2 -lz -licucore -lm -lxml2 -lz -licucore -lm /usr/local/opt/libiconv/lib/libiconv.dylib /usr/local/opt/libiconv/lib/libcharset.dylib</span><br></pre></td></tr></table></figure>

<p>然后重新运行make命令</p>
<p>本文连接：<a target="_blank" rel="noopener" href="https://feilong.tech/2019/11/11/make-php-error">https://feilong.tech/2019/11/11/make-php-error</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2019/11/11/make-php-error/" data-id="cl0oi8mg8003q417tc1b4gil5" data-title="mac 由于libiconv导致编译PHP7 ld: symbol(s) not found for architecture x86_64错误" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/PHP/" rel="tag">PHP</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/PHP7/" rel="tag">PHP7</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/PHP%E6%BA%90%E7%A0%81/" rel="tag">PHP源码</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-ascii-unicode-utf-8" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/11/08/ascii-unicode-utf-8/" class="article-date">
  <time class="dt-published" datetime="2019-11-08T06:34:15.000Z" itemprop="datePublished">2019-11-08</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Linux/">Linux</a>►<a class="article-category-link" href="/categories/%E7%AE%97%E6%B3%95/">算法</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/11/08/ascii-unicode-utf-8/">ASCII、Unicode和UTF-8的关系</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>对于我来说，字符集的相关知识，一直都是噩梦。Unicode、utf-8、ASCII….搞得头都大了。我也特意梳理了下，字符集之间的关系。而且，之前在贝壳面试，面试官也问了我关于unicode编码的事情。</p>
<h3 id="ASCII"><a href="#ASCII" class="headerlink" title="ASCII"></a>ASCII</h3><h4 id="由来"><a href="#由来" class="headerlink" title="由来"></a>由来</h4><p>ASCII的字符集算是出来最早的了，最初是来源于美国。ASCII第一次以规范标准的类型发表是在1967年，最后一次更新则是在1986年，到目前为止共定义了128个字符。除了我们常见的英文字母，还包含了各种英文的标点符号等等。在英语中，用128个符号编码便可以表示所有，但是用来表示其他语言，128个符号是不够的。</p>
<h4 id="存在的问题"><a href="#存在的问题" class="headerlink" title="存在的问题"></a>存在的问题</h4><p>但是这样是有问题的。举个例子，法语的字母上方是有音标的，它就无法使用ASCII的编码表示。于是，一些欧洲的国家决定，利用字节中闲置的最高位编入新的符号，这样一来，这些欧洲国家使用的编码体系，可以表示最多256个符号。由最开始的 0xxx xxxx (2^7&#x3D;128) 变成了 1xxx xxxx (2^8&#x3D;256)</p>
<h3 id="Unicode"><a href="#Unicode" class="headerlink" title="Unicode"></a>Unicode</h3><p>后来，大家都在考虑，如果有一种字符集，能够包含所有的字符，那就好了。</p>
<p>于是，在 1991 年，国际标准化组织和统一码联盟组织各自开发了 ISO&#x2F;IEC 10646（USC）和 Unicode 项目。他们俩的野心和当时的秦始皇一样，一统江湖。后来，两个组织开始进行讨论，决定把彼此的工作内容合并，但是项目还是独立存在，各自发布自己的标准，但是要保持兼容。后来由于Unicode的好记，就被广为流传。其实，Unicode的含义可以解释为union code。</p>
<p>在表示一个Unicode的字符时，通常会用U+ 后面跟着十六进制的数字来表示这一个字符。</p>
<p>Unicode的编码，延续了ASCII的编码，0-127位，还是代表了ASCII的编码，从128以后，才是其他的编码。</p>
<p>比如 在unicode的<code>U+ 0041</code>代表了大写的<code>A</code>, 在ascii编码16进制也是<code>\x41</code></p>
<p>再比如，<code>肥</code>的unicode编码表示为<code>U+ 80a5</code></p>
<h3 id="UTF-8"><a href="#UTF-8" class="headerlink" title="UTF-8"></a>UTF-8</h3><p>utf-8的的全拼是<code>Universal Character Set/Unicode Transformation Format</code>,翻译过来就是<code>Unicode格式化</code>，很明显是一个动词，表示把字符转换成8位的Unicode。</p>
<p>举个例子:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">I’m 肥龙</span><br></pre></td></tr></table></figure>

<p>使用unicode的表示为</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">I U+49</span><br><span class="line"><span class="string">&#x27; U+20</span></span><br><span class="line"><span class="string">m U+6D</span></span><br><span class="line"><span class="string">肥 U+80A5</span></span><br><span class="line"><span class="string">龙 U+9F99</span></span><br></pre></td></tr></table></figure>

<p>但是，在计算机里，统一都是2进制的存储的，所以转换成2进制表示为</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">I  00000000 01001001</span><br><span class="line"><span class="string">&#x27;  00000000 00100000</span></span><br><span class="line"><span class="string">m  00000000 01101101</span></span><br><span class="line"><span class="string">   00000000 00000000</span></span><br><span class="line"><span class="string">肥  10000000 10100101</span></span><br><span class="line"><span class="string">龙  10011111 10011001</span></span><br></pre></td></tr></table></figure>

<p>UTF-8规定：</p>
<p>1、单字节的字符，字节的第一位设为0，对于英文文本，utf-8只占用一个字符，所以第一位都是0</p>
<p>2、n个字节，第一个字节的前n个设为1，第n+1设为0，后面的字节前两位都设为10，这n个字节的其余空位填充该字符unicode码，高位用0补足。</p>
<p>所以，转换成UTF-8过程</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">肥</span><br><span class="line">---------------------------</span><br><span class="line">10000000 10100101   二进制</span><br><span class="line">1110 10 10         初始化模板</span><br><span class="line">11101000 10000010 10100101 补全</span><br><span class="line">e8 82 a5            16进制</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">龙</span><br><span class="line">---------------------------</span><br><span class="line">10011111 10011001 二进制</span><br><span class="line">1110 10 10          初始化模板</span><br><span class="line">11101001 10111110 10011001 补全</span><br><span class="line">e9 be 99            16进制</span><br></pre></td></tr></table></figure>

<p>所以最后的转换成utf-8的编码</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">I  01001001</span><br><span class="line"><span class="string">&#x27;  00100000</span></span><br><span class="line"><span class="string">m  01101101</span></span><br><span class="line"><span class="string">   00000000</span></span><br><span class="line"><span class="string">肥  11101000 10000010 10100101</span></span><br><span class="line"><span class="string">龙  11101001 10111110 10011001</span></span><br></pre></td></tr></table></figure>

<p>使用Python验证一下结果</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; a=u&#x27;肥龙&#x27;</span><br><span class="line">&gt;&gt;&gt; a</span><br><span class="line">u&#x27;\u80a5\u9f99&#x27;</span><br><span class="line">&gt;&gt;&gt; b=a.encode(&#x27;utf8&#x27;)</span><br><span class="line">&gt;&gt;&gt; b</span><br><span class="line">&#x27;\xe8\x82\xa5\xe9\xbe\x99&#x27;</span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>

<p>可以看到，省略了一部分空间。汉子的编码多了一个字节，英文的编码少了一个字节，总共节省了2个字节的空间！</p>
<p>本文连接： <a target="_blank" rel="noopener" href="https://feilong.tech/2019/11/08/ascii_unicode_utf-8">https://feilong.tech/2019/11/08/ascii_unicode_utf-8</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2019/11/08/ascii-unicode-utf-8/" data-id="cl0oi8mdt0005417t7vwld2e6" data-title="ASCII、Unicode和UTF-8的关系" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ascii/" rel="tag">ascii</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/unicode/" rel="tag">unicode</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/utf-8/" rel="tag">utf-8</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%BC%96%E7%A0%81/" rel="tag">编码</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-nohup" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/11/03/nohup/" class="article-date">
  <time class="dt-published" datetime="2019-11-03T10:39:50.000Z" itemprop="datePublished">2019-11-03</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Linux/">Linux</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/11/03/nohup/">nohup后面2&gt;&amp;1的理解</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>我们在后台运行命令的时候，除了会借助一些后台进程守护工具，也会用到Linux的nohup，比如：<code>nohup command &gt; /dev/null 2&gt;&amp;1 &amp;</code>。对于命令的含义，其实大家都知道，无外乎就是<code>不输出任何的错误信息</code>。但是对于技术，我更希望自己能够知其然而知其所以然</p>
<h3 id="1和2？"><a href="#1和2？" class="headerlink" title="1和2？"></a>1和2？</h3><p>首先，先说下数字1和2的含义： <code>Linux shell中有三种输入输出，分别为标准输入，标准输出，错误输出，分别对应0，1，2</code></p>
<h3 id="分解命令"><a href="#分解命令" class="headerlink" title="分解命令"></a>分解命令</h3><p>其实命令<code>nohup command &gt; /dev/null 2&gt;&amp;1 &amp;</code> 应该进行拆分为多个部分</p>
<ul>
<li>nohup</li>
<li>command &gt; &#x2F;dev&#x2F;null 2&gt;&amp;1</li>
<li>&amp;</li>
</ul>
<p>第一部分肯定不用说，就是nohup的用法，第三部分的含义，就是代码后台运行命令，其实也不用说。令人费解的就是第二部分的含义。</p>
<p>开头的时候，我有说过，其实数字是Linux规定的一种输出的信号，在编程语言中，&amp;通常是代表变量的内存地址，所以 2&gt;&amp;1代表了，把<code>错误输出</code>写到<code>标准输出</code>里面。</p>
<h3 id="举个例子"><a href="#举个例子" class="headerlink" title="举个例子"></a>举个例子</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ ll</span><br><span class="line">total 72</span><br><span class="line">-rw-r--r--  1 sf  staff     36 10 30 11:17 1</span><br><span class="line">-rw-r--r--  1 sf  staff    111 10 30 10:40 CMakeLists.txt</span><br><span class="line">drwxr-xr-x  7 sf  staff    224 10 30 10:41 cmake-build-debug</span><br><span class="line">-rw-r--r--  1 sf  staff     96 10 30 10:40 main.cpp</span><br><span class="line">-rw-------  1 sf  staff      0 10 30 11:11 nohup.out</span><br><span class="line">-rwxr-xr-x  1 sf  staff  12732 10 30 10:45 sigtest</span><br><span class="line">-rw-r--r--  1 sf  staff    258 10 30 10:45 sigtest.cpp</span><br><span class="line">-rw-r--r--  1 sf  staff     23 10 30 11:02 tt.txt</span><br></pre></td></tr></table></figure>

<h4 id="验证数字1是不是标准输出的意思"><a href="#验证数字1是不是标准输出的意思" class="headerlink" title="验证数字1是不是标准输出的意思"></a>验证数字1是不是标准输出的意思</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># shell-demo0</span></span><br><span class="line">$ ll ./ 1&gt;output.txt</span><br><span class="line">$ <span class="built_in">cat</span> output.txt</span><br><span class="line">total 64</span><br><span class="line">-rw-r--r--  1 sf  staff    111 10 30 10:40 CMakeLists.txt</span><br><span class="line">drwxr-xr-x  7 sf  staff    224 10 30 10:41 cmake-build-debug</span><br><span class="line">-rw-r--r--  1 sf  staff     96 10 30 10:40 main.cpp</span><br><span class="line">-rw-------  1 sf  staff      0 10 30 11:11 nohup.out</span><br><span class="line">-rw-r--r--  1 sf  staff      0 10 30 11:48 output.txt</span><br><span class="line">-rwxr-xr-x  1 sf  staff  12732 10 30 10:45 sigtest</span><br><span class="line">-rw-r--r--  1 sf  staff    258 10 30 10:45 sigtest.cpp</span><br><span class="line">-rw-r--r--  1 sf  staff     23 10 30 11:02 tt.txt</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># shell-demo1</span></span><br><span class="line">$ ll mmm 1&gt;output1.txt</span><br><span class="line"><span class="built_in">ls</span>: mmm: No such file or directory</span><br><span class="line">$ <span class="built_in">cat</span> output1.txt</span><br><span class="line">$</span><br></pre></td></tr></table></figure>

<p>上面的两个例子证明了一个问题</p>
<ul>
<li>shell-demo0在output.txt文件里面的内容，和ll的显示内容一致</li>
<li>shell-demo1中，我查看了一个不存在的文件，但是错误信息没有写入到文件output1.txt，而是输出到了屏幕上</li>
</ul>
<p>结论：数字1确实是标准输出的含义</p>
<h4 id="验证数字2是不是错误信息的含义"><a href="#验证数字2是不是错误信息的含义" class="headerlink" title="验证数字2是不是错误信息的含义"></a>验证数字2是不是错误信息的含义</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#shell-demo2</span></span><br><span class="line">$ ll ./ 2&gt;output2.txt</span><br><span class="line">total 72</span><br><span class="line">-rw-r--r--  1 sf  staff    111 10 30 10:40 CMakeLists.txt</span><br><span class="line">drwxr-xr-x  7 sf  staff    224 10 30 10:41 cmake-build-debug</span><br><span class="line">-rw-r--r--  1 sf  staff     96 10 30 10:40 main.cpp</span><br><span class="line">-rw-------  1 sf  staff      0 10 30 11:11 nohup.out</span><br><span class="line">-rw-r--r--  1 sf  staff    443 10 30 11:48 output.txt</span><br><span class="line">-rw-r--r--  1 sf  staff      0 10 30 11:51 output1.txt</span><br><span class="line">-rw-r--r--  1 sf  staff      0 10 30 11:56 output2.txt</span><br><span class="line">-rwxr-xr-x  1 sf  staff  12732 10 30 10:45 sigtest</span><br><span class="line">-rw-r--r--  1 sf  staff    258 10 30 10:45 sigtest.cpp</span><br><span class="line">-rw-r--r--  1 sf  staff     23 10 30 11:02 tt.txt</span><br><span class="line">$ <span class="built_in">cat</span> output2.txt</span><br><span class="line">$ </span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#shell-demo3</span></span><br><span class="line">$ ll mmm 2&gt;output3.txt</span><br><span class="line">$ <span class="built_in">cat</span> output3.txt</span><br><span class="line"><span class="built_in">ls</span>: mmm: No such file or directory</span><br></pre></td></tr></table></figure>

<p>上面的两个例子证明了一个问题</p>
<ul>
<li>shell-demo2在使用数字2的时候，当前目录下的文件信息在屏幕输出，没有写入到文件output2.txt</li>
<li>shell-demo3中，错误信息输出到了output3.txt</li>
</ul>
<p>结论：数字2确实是错误输出的含义</p>
<h4 id="2-gt-1和2-gt-amp-1"><a href="#2-gt-1和2-gt-amp-1" class="headerlink" title="2&gt;1和2&gt;&amp;1"></a>2&gt;1和2&gt;&amp;1</h4><p>接下来，我们对比下2&gt;1和2&gt;&amp;1的区别</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#shell-demo4</span></span><br><span class="line">$ ll ./ mm &gt;output4.txt 2&gt;1</span><br><span class="line">$ <span class="built_in">cat</span> output4.txt</span><br><span class="line">./:</span><br><span class="line">total 72</span><br><span class="line">-rw-r--r--  1 sf  staff     34 10 30 13:33 1</span><br><span class="line">-rw-r--r--  1 sf  staff    111 10 30 10:40 CMakeLists.txt</span><br><span class="line">drwxr-xr-x  7 sf  staff    224 10 30 10:41 cmake-build-debug</span><br><span class="line">-rw-r--r--  1 sf  staff     96 10 30 10:40 main.cpp</span><br><span class="line">-rw-------  1 sf  staff      0 10 30 11:11 nohup.out</span><br><span class="line">-rw-r--r--  1 sf  staff      0 10 30 13:33 output4.txt</span><br><span class="line">-rwxr-xr-x  1 sf  staff  12732 10 30 10:45 sigtest</span><br><span class="line">-rw-r--r--  1 sf  staff    258 10 30 10:45 sigtest.cpp</span><br><span class="line">-rw-r--r--  1 sf  staff     23 10 30 11:02 tt.txt</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#shell-demo5</span></span><br><span class="line">$ ll ./ mm &gt;output5.txt 2&gt;&amp;1</span><br><span class="line">$ <span class="built_in">cat</span> output5.txt</span><br><span class="line"><span class="built_in">ls</span>: mm: No such file or directory</span><br><span class="line">./:</span><br><span class="line">total 88</span><br><span class="line">-rw-r--r--  1 sf  staff     34 10 30 13:33 1</span><br><span class="line">-rw-r--r--  1 sf  staff    111 10 30 10:40 CMakeLists.txt</span><br><span class="line">drwxr-xr-x  7 sf  staff    224 10 30 10:41 cmake-build-debug</span><br><span class="line">-rw-r--r--  1 sf  staff     96 10 30 10:40 main.cpp</span><br><span class="line">-rw-------  1 sf  staff      0 10 30 11:11 nohup.out</span><br><span class="line">-rw-r--r--  1 sf  staff    527 10 30 13:34 output4.txt</span><br><span class="line">-rw-r--r--  1 sf  staff     34 10 30 13:34 output5.txt</span><br><span class="line">-rwxr-xr-x  1 sf  staff  12732 10 30 10:45 sigtest</span><br><span class="line">-rw-r--r--  1 sf  staff    258 10 30 10:45 sigtest.cpp</span><br><span class="line">-rw-r--r--  1 sf  staff     23 10 30 11:02 tt.txt</span><br></pre></td></tr></table></figure>

<p>对比应该比较明显了吧。</p>
<p><code>如果是使用2&gt;1，那么代表错误信息会写入到标准信息里面，但是会被标准信息所覆盖</code></p>
<p><code>如果是使用2&gt;&amp;1，那么代表错误信息会写入到标准信息的内存地址里，然后再和标准信息一起写到输出文件里面</code></p>
<p>本文链接：<a target="_blank" rel="noopener" href="https://feilong.tech/2019/11/03/nohup/">https://feilong.tech/2019/11/03/nohup/</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2019/11/03/nohup/" data-id="cl0oi8mgv004r417tb9l6guu2" data-title="nohup后面2&gt;&amp;1的理解" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/" rel="tag">Linux</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-code-to-lose-weight" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/10/08/code-to-lose-weight/" class="article-date">
  <time class="dt-published" datetime="2019-10-08T14:11:08.000Z" itemprop="datePublished">2019-10-08</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Life/">Life</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/10/08/code-to-lose-weight/">程序员应该如何减肥</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>从开始减肥到现在，已经是2-3个年头了，在大学的时候，基本上每天除了睡就是吃，再加上自己时不时晚上出去通宵，所以体重从大一的160斤，毕业后接近200斤。毕业之后，由于没有注意体重的问题，没过多久就超过了200斤。</p>
<p><img src="/uploads/2019/10/IMG_0825-225x300.jpg"></p>
<p><img src="/uploads/2019/10/IMG_1103.png"></p>
<p>这两张是大一入学和大学刚毕业的对比照片。不得不说，大学真的算是“养猪场”了。</p>
<h3 id="减肥的原因"><a href="#减肥的原因" class="headerlink" title="减肥的原因"></a>减肥的原因</h3><p>我最开始是在海淀工作，后来公司搬到了昌平。上班的时候会路过一个天桥，但是有一次我发现，上天桥的时候，自己呼哧呼哧的喘着粗气，我才意识到：我应该开始减肥了，再这样下去我就不行了。</p>
<h3 id="减肥的过程"><a href="#减肥的过程" class="headerlink" title="减肥的过程"></a>减肥的过程</h3><p>当时刚毕业到北京，手里没什么钱，四个同学挤在了一个10平米的公寓，月租1300块，平均每人每个月300多。每天吃饭都成问题，更没有闲钱办健身卡，所以就买了一个瑜伽垫，在公寓里面使用keep上“减脂课”。</p>
<p><img src="/uploads/2019/10/WechatIMG5-139x300.jpeg"></p>
<p>当时练得最多的就是“hiit”的减脂课了。</p>
<p>在北京工作一段时间之后，生活稍微宽裕了一些，自己就在咸鱼买了人生中的第一张健身卡，花了800块钱，开始了自己的健身房锻炼的生涯。</p>
<h3 id="减肥的结果"><a href="#减肥的结果" class="headerlink" title="减肥的结果"></a>减肥的结果</h3><p>第一次到了健身房，和大家一样，基本上就是跑步，不会使用器械。不过好在keep上面有一些训练的动作，里面会交一些器械使用的注意事项。慢慢的，也开始熟能生巧。也越来越有感觉。</p>
<p>从减肥，到现在已经2年多了，现在体重基本上维持在160斤左右，虽然没有腹肌，但是也基本算是“穿衣显瘦，脱衣有肉”。</p>
<h3 id="减肥的误区"><a href="#减肥的误区" class="headerlink" title="减肥的误区"></a>减肥的误区</h3><p>减肥的道理其实大家都懂“管住嘴，迈开腿”，也就是说，消耗 &gt; 摄入。但是很多人依然会减肥失败，原因是什么？</p>
<h4 id="大家都太着急了"><a href="#大家都太着急了" class="headerlink" title="大家都太着急了"></a>大家都太着急了</h4><p>其实我们长胖，并不是几天就一下子变胖的，我们在开始减肥的时候，发现前期没有什么明显的变化，内心就开始动摇了，在加上我们身处一个快节奏的生活，身边再有几个“看热闹不嫌事大”的损友，所以很容易就放弃减肥了。</p>
<h4 id="不吃主食"><a href="#不吃主食" class="headerlink" title="不吃主食"></a>不吃主食</h4><p>糖分在为我们大脑的供能有很重要的作用，当你不吃主食，大脑的糖分不足，就容易出现头晕、易怒。下午就很容易出现犯困。</p>
<p>晚上不吃主食，到了半夜睡眠的时候，身体的缺少能量，会开始分解肝糖原进行供能，肝糖原不足之后，就会分解肌糖原，进而也会影响肌肉的合成。所以晚上，我们应该适当少吃点主食。或者使用土豆作为代餐主食。因为在我们身体中，胰岛素是维持血糖平衡的重要物质，如果血糖一旦升高，那么胰岛素就会把多余的血糖合成脂肪，这要是为什么奶茶等饮料容易长胖的重要原因！</p>
<h4 id="肌肉重不重要"><a href="#肌肉重不重要" class="headerlink" title="肌肉重不重要"></a>肌肉重不重要</h4><p>很多人会说，“我不想长肌肉，我只想瘦一点”。</p>
<p>我们的身体，在活动的时候，是由肌肉带动骨骼，身体的能量消耗，在于肌肉和骨骼的牵引，所以一般来说，肌肉量相对比较大的，消耗的能量也相对较大。这也就是我们常说的基础代谢。所以肌肉在减值过程中具有很重要的作用。</p>
<p>其实肌肉的生长，是一个复杂的过程。</p>
<p>肌肉的基本单位是肌肉纤维。肌肉想要得到生长，需要先把肌肉纤维产生破损，然后再通过氨基酸，将肌肉纤维进行修复，所以没有足够的蛋白质和氨基酸，肌肉增长会是一个比较慢的过程。除此以外，还需要足够的休息，所以 蛋白质+训练+休息 三者结合肌肉才会得到足够的生长。</p>
<h3 id="程序员怎么减肥？"><a href="#程序员怎么减肥？" class="headerlink" title="程序员怎么减肥？"></a>程序员怎么减肥？</h3><h4 id="调整饮食"><a href="#调整饮食" class="headerlink" title="调整饮食"></a>调整饮食</h4><p><img src="/uploads/2019/10/d15ea020bfcc444181bfd16a88f53909-300x184.jpeg"></p>
<p>首先，我们应该调整一下自己的饮食结构。上面说了，胰岛素是维持血糖的重要物质所以我们应该在日常生活中，调整饮食结构，将主食的比例降低一点，将蛋白质的比例稍微调高一点。这样可以让我们的血糖变化小一点，减少过多的糖分合成脂肪的可能性。</p>
<h4 id="增加无氧训练"><a href="#增加无氧训练" class="headerlink" title="增加无氧训练"></a>增加无氧训练</h4><p><img src="/uploads/2019/10/8f3d71c9c5b54eaab2527b13b3531100-300x193.jpeg"></p>
<p>肌肉是维持基础代谢的一个重要的因素。除了我们增加蛋白质的摄入比例以外，我们也应该做一些无氧训练。比如健身房做一些器械的训练，但是我们减肥的目的是为了健康，不是为了举重。</p>
<p>在健身房，我不建议请私教。 因为现在很多商业健身房都是盈利为目的，买课之前和买课之后态度差很多，私教素质也是参差不齐。所以如果请私教，还是需要擦亮眼睛。可以和健身房练得不错的请教一下，其实健身爱好者都是非常谦逊的。</p>
<hr>
<p>以上就是我对程序员减肥的相关感触和理解，我自己个人也是这么走过来的。减肥就想红军长征一样，并不是一蹴而就，而是需要时间的一点点积累，一点点看到变化。加油！</p>
<p>本文连接： <a target="_blank" rel="noopener" href="http://feilong.tech/2019/10/08/code-to-lose-weight">http://feilong.tech/2019/10/08/code-to-lose-weight</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2019/10/08/code-to-lose-weight/" data-id="cl0oi8me1000d417tg02jb0dj" data-title="程序员应该如何减肥" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%81%A5%E5%BA%B7/" rel="tag">健康</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%81%A5%E8%BA%AB/" rel="tag">健身</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%87%8F%E8%82%A5/" rel="tag">减肥</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-linux-ulimit-warning" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/09/30/linux-ulimit-warning/" class="article-date">
  <time class="dt-published" datetime="2019-09-30T08:04:31.000Z" itemprop="datePublished">2019-09-30</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Linux/">Linux</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/09/30/linux-ulimit-warning/">Linux登录提示&#34;-bash: ulimit: open files: 无法修改 limit 值: 不允许的操作&#34;</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h3><p>自己在每次登录服务器的时候，都会出现 <strong>-bash: ulimit: open files: 无法修改 limit 值: 不允许的操作</strong> 的提示信息，根据猜测，应该是登录的时候，执行了什么特殊的命令。通过百度查询了下，应该是登录的时候，执行了 ulimit 的命令。</p>
<h3 id="原因猜测"><a href="#原因猜测" class="headerlink" title="原因猜测"></a>原因猜测</h3><p>一般登录的时候，都会调用 .bashrc 或者 .bash_profile做一些初始化的操作。但是我找到对应的home下面的文件，并！没有！所以猜测，应该调用了全局的profile。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cat</span> /etc/profile</span><br><span class="line">....</span><br><span class="line"><span class="built_in">ulimit</span> -SHn 65535</span><br></pre></td></tr></table></figure>

<p>果然最下面有一个ulimit的执行命令，把命令注释掉，重新登录，问题解决了</p>
<h3 id="关于ulimit"><a href="#关于ulimit" class="headerlink" title="关于ulimit"></a>关于ulimit</h3><p>ulimit的命令主要是用来控制shell程序的资源</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">help</span> <span class="built_in">ulimit</span></span><br><span class="line"><span class="built_in">ulimit</span>: <span class="built_in">ulimit</span> [-SHacdefilmnpqrstuvx] [限制]</span><br><span class="line">    修改 shell 资源限制。</span><br><span class="line"></span><br><span class="line">    在允许此类控制的系统上，提供对于 shell 及其创建的进程所可用的</span><br><span class="line">    资源的控制。</span><br><span class="line"></span><br><span class="line">    选项：</span><br><span class="line">      -S    使用 `soft<span class="string">&#x27;（软）资源限制</span></span><br><span class="line"><span class="string">      -H    使用 `hard&#x27;</span>（硬）资源限制</span><br><span class="line">      -a    所有当前限制都被报告</span><br><span class="line">      -b    套接字缓存尺寸</span><br><span class="line">      -c    创建的核文件的最大尺寸</span><br><span class="line">      -d    一个进程的数据区的最大尺寸</span><br><span class="line">      -e    最高的调度优先级（`<span class="built_in">nice</span><span class="string">&#x27;）</span></span><br><span class="line"><span class="string">      -f    有 shell 及其子进程可以写的最大文件尺寸</span></span><br><span class="line"><span class="string">      -i    最多的可以挂起的信号数</span></span><br><span class="line"><span class="string">      -l    一个进程可以锁定的最大内存尺寸</span></span><br><span class="line"><span class="string">      -m    最大的内存进驻尺寸</span></span><br><span class="line"><span class="string">      -n    最多的打开的文件描述符个数</span></span><br><span class="line"><span class="string">      -p    管道缓冲区尺寸</span></span><br><span class="line"><span class="string">      -q    POSIX 信息队列的最大字节数</span></span><br><span class="line"><span class="string">      -r    实时调度的最大优先级</span></span><br><span class="line"><span class="string">      -s    最大栈尺寸</span></span><br><span class="line"><span class="string">      -t    最大的CPU时间，以秒为单位</span></span><br><span class="line"><span class="string">      -u    最大用户进程数</span></span><br><span class="line"><span class="string">      -v    虚拟内存尺寸</span></span><br><span class="line"><span class="string">      -x    最大的锁数量</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    如果提供了 LIMIT 变量，则它为指定资源的新的值；特别的 LIMIT 值为</span></span><br><span class="line"><span class="string">    `soft&#x27;</span>、`hard<span class="string">&#x27;和`unlimited&#x27;</span>，分别表示当前的软限制，硬限制和无限制。</span><br><span class="line">    否则打印指定资源的当前限制值，不带选项则假定为 -f</span><br><span class="line"></span><br><span class="line">    取值都是1024字节为单位，除了 -t 以秒为单位，-p 以512字节为单位，</span><br><span class="line">    -u 以无范围的进程数量。</span><br><span class="line"></span><br><span class="line">    退出状态：</span><br><span class="line">    返回成功，除非使用了无效的选项或者错误发生。</span><br></pre></td></tr></table></figure>

<p>通过ulimit，我们可以限制某个用户的使用的资源个数，比如我们限制用户打开文件的个数为2</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">ulimit</span> -n 2</span><br><span class="line">$ <span class="built_in">touch</span> a.php</span><br><span class="line">$ <span class="built_in">touch</span> b.php</span><br><span class="line">$ <span class="built_in">touch</span> b.php</span><br></pre></td></tr></table></figure>

<p>打开3个控制台，分别使用vim命令打开三个文件，当打开打开三个文件的时候，就出现了</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ vim c-bash: /dev/null: Too many open files</span><br><span class="line">-bash: 重定向错误: 无法复制文件描述符: Invalid argument</span><br><span class="line">-bash: 2: Invalid argument</span><br><span class="line">-bash: /dev/null: Too many open files</span><br><span class="line">-bash: 重定向错误: 无法复制文件描述符: Invalid argument</span><br><span class="line">-bash: 2: Invalid argument</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2019/09/30/linux-ulimit-warning/" data-id="cl0oi8mg0003e417t2m3h6ima" data-title="Linux登录提示&#34;-bash: ulimit: open files: 无法修改 limit 值: 不允许的操作&#34;" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/" rel="tag">Linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/cli/" rel="tag">cli</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/shell/" rel="tag">shell</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ulimit/" rel="tag">ulimit</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-greedy" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/09/30/greedy/" class="article-date">
  <time class="dt-published" datetime="2019-09-30T06:20:34.000Z" itemprop="datePublished">2019-09-30</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E7%AE%97%E6%B3%95/">算法</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/09/30/greedy/">贪心算法</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h3><p>所谓的贪心算法，是在对问题求解的时候，总是做出在当前看来是最好的选择。也就是说，不从整体最优上进行考虑，所做的仅仅是在某种意义上的局部最优解。</p>
<p>贪心算法没有固定的算法框架，算法设计的关键是贪心策略的选择。贪心算法不是对所有问题都能得到最优解，选择的贪心策略必须具备无后效性，即其他过程，不会影响以前的状态，完全是局部的。</p>
<h3 id="基本思路"><a href="#基本思路" class="headerlink" title="基本思路"></a>基本思路</h3><ul>
<li>建立数学模型来描述问题</li>
<li>把求解的问题分成若干个子问题</li>
<li>对每一个子问题求解，得到子问题的局部最优解</li>
<li>把子问题的局部最优解合成原来界问题的一个解</li>
</ul>
<h3 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h3><h4 id="两地调度（LeetCode-1029）"><a href="#两地调度（LeetCode-1029）" class="headerlink" title="两地调度（LeetCode: 1029）"></a>两地调度（LeetCode: 1029）</h4><p>公司计划面试 2N 人。第 i 人飞往 A 市的费用为 costs[i][0]，飞往 B 市的费用为 costs[i][1]。</p>
<p>返回将每个人都飞到某座城市的最低费用，要求每个城市都有 N 人抵达</p>
<p>示例：</p>
<p>输入：[[10,20],[30,200],[400,50],[30,20]] 输出：110 解释： 第一个人去 A 市，费用为 10。 第二个人去 A 市，费用为 30。 第三个人去 B 市，费用为 50。 第四个人去 B 市，费用为 20。</p>
<p>最低总费用为 10 + 30 + 50 + 20 &#x3D; 110，每个城市都有一半的人在面试。</p>
<h4 id="算法思路"><a href="#算法思路" class="headerlink" title="算法思路"></a>算法思路</h4><p>假设，第一个人去A的成本是a1,去B的成本是b1,那么他去A或者去B的成本差距就是a1-b1，这个成本的差距可证可负，如果成本差距是正数，那么说明这个人去A的价格要比去B的价格贵。</p>
<p>同理，第二个人去A的成本是a2，去B的成本B2，那么他去A和B的成本差距就是a2-b2</p>
<p>…</p>
<p><strong>那么所有人去A和B的成本差的总和就是(a1-b1)+(a2-b2)….+(a2n-b2n)，根据题目的要求，如果安排的成本是最小，那么把成本差从小到大进行排序，那么直接让前n个人去A，另外n个人去B，就能得到满足题干的解了。</strong></p>
<p>员工</p>
<p>A</p>
<p>B</p>
<p>成本差</p>
<p>1</p>
<p>10</p>
<p>b1</p>
<p>a1-b1</p>
<p>2</p>
<p>a2</p>
<p>b2</p>
<p>a2-b2</p>
<p>3</p>
<p>a3</p>
<p>b3</p>
<p>a3-b3</p>
<p>4</p>
<p>a4</p>
<p>b4</p>
<p>a4-b4</p>
<p>5</p>
<p>a5</p>
<p>b5</p>
<p>a5-b5</p>
<p>2n</p>
<p>a2n</p>
<p>b2n</p>
<p>a2n-b2n</p>
<p>将题干引入模型：</p>
<p>员工</p>
<p>A</p>
<p>B</p>
<p>成本差</p>
<p>1</p>
<p>10</p>
<p>20</p>
<p>-10</p>
<p>2</p>
<p>30</p>
<p>200</p>
<p>-170</p>
<p>3</p>
<p>400</p>
<p>50</p>
<p>350</p>
<p>4</p>
<p>30</p>
<p>20</p>
<p>10</p>
<p>成本差分别是 -10，-170，350，10 排序之后的结果： -170，-10，10，350 那么直接让用户2和用户1去A，让用户4和用户3去B。 最低费用是 30+10+50+20&#x3D;110</p>
<h4 id="算法实现"><a href="#算法实现" class="headerlink" title="算法实现"></a>算法实现</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> Integer[][] $costs</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> Integer</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">twoCitySchedCost</span>(<span class="params"><span class="variable">$costs</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$additional</span> = [];</span><br><span class="line">        <span class="variable">$diff</span> = [];</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$costs</span> <span class="keyword">as</span> &amp;<span class="variable">$cost</span>) &#123;</span><br><span class="line">            <span class="variable">$cost</span>[<span class="string">&#x27;diff&#x27;</span>] = <span class="variable">$cost</span>[<span class="number">0</span>]-<span class="variable">$cost</span>[<span class="number">1</span>];</span><br><span class="line">            <span class="variable">$diff</span>[] = <span class="variable">$cost</span>[<span class="number">0</span>]-<span class="variable">$cost</span>[<span class="number">1</span>];</span><br><span class="line">            <span class="keyword">unset</span> (<span class="variable">$cost</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_ invoke__">array_multisort</span>(<span class="variable">$diff</span>, SORT_ASC,<span class="variable">$costs</span> );</span><br><span class="line">        <span class="variable">$total</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="variable">$n</span> = <span class="title function_ invoke__">count</span>(<span class="variable">$costs</span>) / <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span>&lt; <span class="variable">$n</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$total</span> += <span class="variable">$costs</span>[<span class="variable">$i</span>][<span class="number">0</span>] + <span class="variable">$costs</span>[<span class="variable">$i</span>+<span class="variable">$n</span>][<span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$total</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2019/09/30/greedy/" data-id="cl0oi8mfm002a417t2ryh9g8b" data-title="贪心算法" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/PHP/" rel="tag">PHP</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">算法</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%B4%AA%E5%BF%83%E7%AE%97%E6%B3%95/" rel="tag">贪心算法</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-structured-thinking" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/09/26/structured-thinking/" class="article-date">
  <time class="dt-published" datetime="2019-09-26T13:53:49.000Z" itemprop="datePublished">2019-09-26</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E8%87%AA%E6%88%91%E5%8F%8D%E6%80%9D/">自我反思</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/09/26/structured-thinking/">阿里大牛：你必须具备的“结构化思维”</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <blockquote>
<p>在日常工作中，我们时常会碰到这样的情况，有的人讲事情逻辑非常混乱，罗列了很多事项，却把握不到重点，无法把一件事情说清楚。</p>
</blockquote>
<p>这种思维混乱是典型的缺少结构化思维的表现。结构化思维非常重要，不仅仅体现在表达上，也体现在在我们分析问题的过程中。具备结构化思维，才能将问题分析地更全面、更深刻。</p>
<h3 id="什么是结构化思维？"><a href="#什么是结构化思维？" class="headerlink" title="什么是结构化思维？"></a>什么是结构化思维？</h3><p>那么到底是什么是结构化思维呢？简单来说，结构化思维的定义就是：逻辑+套路。</p>
<h4 id="表达要有逻辑"><a href="#表达要有逻辑" class="headerlink" title="表达要有逻辑"></a>表达要有逻辑</h4><p>所谓逻辑是指我们的结构之间必须是有逻辑关系的。例如，你说话的时候用“第一、第二、第三”这个逻辑顺序是合理的，但是，用“第一，第二，第四”就会显得很奇怪。</p>
<p>当然，即使你用了”一、二、三”，也不一定就意味着你的内容有逻辑关系。</p>
<p>想让内容有逻辑关系，我们要学会四种组织思想的逻辑关系：</p>
<ul>
<li><strong>演绎（因果）顺序：</strong> “大前提、小前提、结论”的演绎推理方式就是演绎顺序。比如，经典三段论：所有人都要死，苏格拉底是人，苏格拉底要死。</li>
<li><strong>时间（步骤）顺序：</strong> “第一、第二、第三”，“首先、然后、再者”等，很多的时间顺序同时也是因果顺序。</li>
<li><strong>空间（结构）顺序：</strong> “前端、后端、数据”，“波士顿、纽约、华盛顿”，化整为零（将整体分解为部分）等都是空间顺序。</li>
<li><strong>程度（重要性）顺序：</strong> 比如“最重要、次重要、不重要”等。</li>
</ul>
<p>实际上，所有的逻辑关系都在这四种顺序之内。只要我们的思想和表达在这四种逻辑顺序之内，就是有逻辑的，否则就会显得没有逻辑性。</p>
<h3 id="做事要有套路"><a href="#做事要有套路" class="headerlink" title="做事要有套路"></a>做事要有套路</h3><p>套路是指我们解决问题的方法论，这个也非常重要。比如，5W2H 分析法就是一个非常好的，可以帮助我们分析问题的一个”套路”。</p>
<p>试想一下，面对任何一个问题，你都能从 <strong>Why、Who、When、Where、What、How</strong> 和 <strong>How much</strong>（如下图所示），七个方面去思考。</p>
<p>是不是比不知道这个方法论的人，用点状的思考，5W2H 分析法就全面得多。</p>
<p><img src="/uploads/2019/09/06691048e53ebb9c969c2a49e73dde5d.jpg"></p>
<p>例如，我们在对问题域进行分析和领域知识提炼的时候，就可以用上 5W2H。</p>
<p>5W2H 模型给出了具有指导意义的约束，要求我们提炼的领域知识必须具备模型的六个要素。</p>
<p>这就好比两位侃侃而谈的交谈者，因为有了确定的主题与话题边界，一场本来是漫无目的野鹤闲云似的闲聊就变成了一次深度交流的专题高端对话。</p>
<p><img src="/uploads/2019/09/2ea1c795428ce9ffefb757679d3643ca-1024x839.jpg"></p>
<p>逻辑是一种能力，而套路是方法论，是经验。逻辑是道的东西，而方法论是术的东西。二者都很重要，只有熟练的掌握二者我们才能更好的进行结构化思考。</p>
<h3 id="如何进行结构化思考？"><a href="#如何进行结构化思考？" class="headerlink" title="如何进行结构化思考？"></a>如何进行结构化思考？</h3><p>逻辑性和方法论是结构化思维的底层，那么如何进行结构化思考呢？这也是有方法论的，总的来说是有两个步骤，首先是“建立中心”，然后再进行“分解”。</p>
<h4 id="建立中心"><a href="#建立中心" class="headerlink" title="建立中心"></a>建立中心</h4><p><strong>建立中心也就是要定义清楚要解决的问题，要明确目标。</strong>这是我们结构的顶层节点，也是一种以终为始的思考方式。也就是说，我们首先要搞清楚 Why，然后再进行 How。</p>
<p>建立中心有两种方式</p>
<ul>
<li><strong>自上而下：</strong> _适用于问题比较明确的情况，我们只需要找到问题的核心要素即可，然后进行展开即可_。</li>
<li><strong>自下而上：</strong> <em>对于问题不够明确的情况，我们需要对多种杂乱的内容，进行分类、剪枝、归纳汇总成一个中心。</em></li>
</ul>
<p>建立中心通常不会是一次成型的，随着对问题理解的变化，对中心的抽象也会进行相应的调整。</p>
<p>不同的抽象层次其面对的问题宽度是不一样的。具体要用哪个层次的抽象作为“中心”，要视具体情况而定。</p>
<p>比如面对“系统 Bug 多”的问题，向上抽象是“提升代码质量”，向下抽象是“加强测试”，都可以作为中心，选择哪个为中心取决于你当前要解决的问题是什么。</p>
<p><img src="/uploads/2019/09/6775a06332398a970ead38fbf686ed1c.jpg"></p>
<h4 id="结构化分解"><a href="#结构化分解" class="headerlink" title="结构化分解"></a>结构化分解</h4><p>确定完中心之后，我们需要构建一个结构，使用结构化的思维对问题进行分解。</p>
<p>分解的策略就是我们上文提到的四种逻辑顺序，即演绎顺序、时间顺序、空间顺序和程度顺序。</p>
<p>在做空间分解的时候，要注意满足 MECE（Mutually Exclusive Collectively Exhaustive，相互独立，完全穷尽）原则。</p>
<p>比如我们要对衣服进行分类，如果按照季节和风格进行分类，就会出现互相重叠，并且不能穷尽的情况，也就不满足 MECE。这种分类是逻辑混乱的。</p>
<p><img src="/uploads/2019/09/56d42db36fa7bfef3170fa9a35c94942.jpg"></p>
<p>我们可以按季节分：春秋装，冬装，夏装。除了这三类之外，没有其他季节了，这个就是「不遗漏」。</p>
<p><img src="/uploads/2019/09/c3404ee1406c86e1a62ec34ca02c6c21.jpg"></p>
<h3 id="结构化思维应用"><a href="#结构化思维应用" class="headerlink" title="结构化思维应用"></a>结构化思维应用</h3><h4 id="如何落地新团队"><a href="#如何落地新团队" class="headerlink" title="如何落地新团队"></a>如何落地新团队</h4><p>想象这样一个场景，你刚刚入职一家新公司，或者转岗到一个新团队，作为一个技术人，你将如何落地开展你的工作呢？</p>
<p>这里，我们就能用上结构化思维来帮我们理清思路，从而有条不紊的开展工作了。</p>
<p>我们要知道对一个企业来说，核心要素无外乎就是业务、技术和人，也就是说这三个要素是我们要建立的中心。</p>
<p>基于这个中心，我们可以进行进一步拆解，形成子结构。然后对子结构再进行分析找到应对策略。</p>
<p>这样一步步递进，我们就已经在用结构化思维解决如何落地新团队的问题了。</p>
<p><img src="/uploads/2019/09/70f76f02c0b1db1184a24587759ebd55-1024x486.jpg"></p>
<p>①熟悉业务</p>
<p>了解产品：任何一个团队都有自己要负责的产品，申请一个测试账号去用一下产品，是熟悉产品比较好的方式。</p>
<p>了解流程：任何业务都有自己的业务流程，而业务流里面最核心的是信息流。我们可以通过人员采访，了解关键节点的信息输入和信息输出；可以画一些泳道活动图，理清楚系统的主要角色，以及他们之间的交互关系。</p>
<p>客户走访：通过走访客户，我们可以更加获得业务的第一手资料，更加贴近业务和客户诉求。</p>
<p>②熟悉技术</p>
<p>了解系统架构：可以让团队的技术人员介绍下他们当初系统设计和架构的思路。</p>
<p>了解领域模型：查看关键的核心表结构和系统 API，这样可以快速了解系统的领域模型。</p>
<p>了解代码结构：下载系统工程，熟悉整个工程结构和模块职责。以一个重要的流程为入手点，阅读代码，看清楚核心的执行逻辑。做一个小需求，掌握相关的流程和权限。</p>
<p>③熟悉人</p>
<p>了解组织结构：查看公司的组织树，知道公司大概是如何运作的，以及哪些是KP（Key Person，关键人）。</p>
<p>比如，一个典型的电商公司会包括产品部、运营部、销售部、技术部、人力资源部、财务部、法务部等。</p>
<p>了解人员角色：了解公司都有哪些岗位，以及各岗位的职责范围。</p>
<p>拜山头：找到和自己工作息息相关的岗位人员，比如产品和运营。积极和他们沟通，向他们请教业务问题，多多交流。</p>
<p>这样一方面可以建立更好的人际关系，另一方面也可以更快地熟悉业务。</p>
<h4 id="打造极客文化"><a href="#打造极客文化" class="headerlink" title="打造极客文化"></a>打造极客文化</h4><p>我最近刚刚转岗到新部门，新部门的老板抛给我一个命题：如何帮助技术团队打造极客文化？</p>
<p>这个问题的中心很明确，接下来，看看我是如何使用结构化思维来解这个问题的。</p>
<p>首先我们从空间顺序进行分解，也就是打造极客文化，我们可以去做哪些事情。</p>
<p><img src="/uploads/2019/09/9620f5c9626eb14d0f74bfe4f8cd3dfa-1024x223.jpg"></p>
<p>确定完要做的事情，我们还可以按照时间顺序对如何落地这些事情进行分解。</p>
<p><img src="/uploads/2019/09/b57a58a76b9064183907a60d8e5cc4c2-1024x113.jpg"></p>
<p>这样把按照这两个维度进行结构化拆解的方案给到老板，老板就会很清晰地知道你的规划和落地策略了。</p>
<h4 id="如何做晋升述职"><a href="#如何做晋升述职" class="headerlink" title="如何做晋升述职"></a>如何做晋升述职</h4><p>在阿里巴巴已经做了好几年的晋升评委，发现很多同学都缺乏结构化思维，冗长的 PPT 里，却不能把价值说清楚，不能把推导过程说清楚。实际上，我们需要有一些方法论来指导我们进行关键述职。</p>
<p>接下来，我主要说一下述职中存在的两个典型问题：“罗列事情”和“价值的背后”。</p>
<p>①罗列事情</p>
<p>对自己做过的事情进行简单罗列，也许你的确做了不少事情。但是不能体现你对问题思考的深度和做这个事情带来的价值。</p>
<p>这样的述职很难打动评委，更结构化的表达应该是：“提出问题，定义问题，分析问题，解决问题，最后是展望未来”。</p>
<p>这是一个经典的表述问题的结构，也是麦肯锡推荐的问题解决的框架。</p>
<p><img src="/uploads/2019/09/c5c697abb46b77ada71f04d57b73e550.jpg"></p>
<p>类似的框架还有 Zoom in&#x2F;Zoom out。 我们说事情时，应该像电影镜头一样，先从远拉近，再由近拉远。</p>
<p>Zoom in 是先从宏观背景开始，首先让大家知道你的事情发生的背景，为什么这事重要？然后讲到具体细节，怎么做成的？解决了什么问题？背后的思考是什么？</p>
<p>最后 Zoom out，再从细节调回到整体，结果是什么，带来的客户价值是什么，你对未来的思考是什么。</p>
<p>②价值的背后</p>
<p>把价值说清楚的确很重要，正所谓：路走对了，就不怕远。如果你连价值都不明确，后面做的再多也是白搭。但是，仅仅阐述价值也是不够的，会让人觉得你有邀功之嫌。</p>
<p>比如你说：“我主导研发的风控系统把公司的坏账率从 5% 降低到 2%”。这样的表述是不够的，你还需要把价值背后的过程和思考说清楚。</p>
<p>对于这个结果，评委可能会问： 之前为什么那么高？ 为什么你的方法可以降低？是如何归因的？ 具体解决了什么问题？ 是否可以总结出一套办法，以后别人也能用这个办法解决这些问题？</p>
<p>如果你在评委提问之前，就能对这些问题进行深入思考和适当呈现。那么你就是既有结果又有过程了。</p>
<p>通过这些案例，我们可以看到具备结构化思维，可以帮助我们快速的理清处理问题的思路，提升工作效率。</p>
<p>经常锻炼结构化思维，可以极大的提升我们职场竞争力，让工作有条不紊，事半功倍。</p>
<h3 id="出处"><a href="#出处" class="headerlink" title="出处"></a>出处</h3><p>转载自微信公众号：从码农到工匠（ID：craftsman_frank）</p>
<p>本文连接：<a target="_blank" rel="noopener" href="http://feilong.tech/2019/09/26/structured-thinking/">http://feilong.tech/2019/09/26/structured-thinking/</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2019/09/26/structured-thinking/" data-id="cl0oi8mih007y417t1ecxetx0" data-title="阿里大牛：你必须具备的“结构化思维”" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%A8%8B%E5%BA%8F%E5%91%98/" rel="tag">程序员</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%87%AA%E6%88%91%E8%A1%A8%E8%BE%BE/" rel="tag">自我表达</a></li></ul>

    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/10/">10</a><a class="extend next" rel="next" href="/page/3/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Docker/">Docker</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Git/">Git</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Go/">Go</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Life/">Life</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">Linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Mysql/">Mysql</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Nginx/">Nginx</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Nodejs/">Nodejs</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/PHP/">PHP</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/PHP%E6%BA%90%E7%A0%81/">PHP源码</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/PHP%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">PHP设计模式</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E4%BB%A5%E5%A4%AA%E5%9D%8A/">以太坊</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%AE%97%E6%B3%95/">算法</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%87%AA%E6%88%91%E5%8F%8D%E6%80%9D/">自我反思</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Apollo/" rel="tag">Apollo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HyperLogLog/" rel="tag">HyperLogLog</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/" rel="tag">Linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mac/" rel="tag">Mac</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MySQL/" rel="tag">MySQL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PHP/" rel="tag">PHP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PHP7/" rel="tag">PHP7</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PHP7%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/" rel="tag">PHP7垃圾回收</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PHP%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F/" rel="tag">PHP原型模式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PHP%E6%BA%90%E7%A0%81/" rel="tag">PHP源码</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PHP%E7%B2%BE%E5%BA%A6/" rel="tag">PHP精度</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PHP%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" rel="tag">PHP设计模式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Redis/" rel="tag">Redis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ascii/" rel="tag">ascii</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/blockchain/" rel="tag">blockchain</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/brew/" rel="tag">brew</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cli/" rel="tag">cli</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/devops/" rel="tag">devops</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/docker/" rel="tag">docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/docker-network/" rel="tag">docker network</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/docker%E5%AE%89%E5%85%A8/" rel="tag">docker安全</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/http/" rel="tag">http</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/json/" rel="tag">json</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/libnetwork/" rel="tag">libnetwork</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nginx/" rel="tag">nginx</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/shell/" rel="tag">shell</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tcp/" rel="tag">tcp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/token/" rel="tag">token</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ulimit/" rel="tag">ulimit</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/unicode/" rel="tag">unicode</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/utf-8/" rel="tag">utf-8</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BB%A5%E5%A4%AA%E5%9D%8A/" rel="tag">以太坊</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%81%A5%E5%BA%B7/" rel="tag">健康</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%81%A5%E8%BA%AB/" rel="tag">健身</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%86%85%E5%AD%98/" rel="tag">内存</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%87%8F%E8%82%A5/" rel="tag">减肥</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%87%BA%E5%9B%BD%E6%B8%B8/" rel="tag">出国游</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8C%BA%E5%9D%97%E9%93%BE/" rel="tag">区块链</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%9B%A2%E5%BB%BA/" rel="tag">团建</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AE%B9%E5%99%A8/" rel="tag">容器</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/" rel="tag">微服务</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%88%90%E9%95%BF%E8%BF%9B%E9%98%B6/" rel="tag">成长进阶</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%99%AE%E5%90%89%E5%B2%9B/" rel="tag">普吉岛</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6/" rel="tag">智能合约</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%AF%94%E7%89%B9%E5%B8%81/" rel="tag">比特币</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%B3%B0%E5%9B%BD/" rel="tag">泰国</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%A7%81%E6%9C%89%E9%93%BE/" rel="tag">私有链</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%A8%8B%E5%BA%8F%E5%91%98/" rel="tag">程序员</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">算法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BB%9F%E8%AE%A1/" rel="tag">统计</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BC%96%E7%A0%81/" rel="tag">编码</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%87%AA%E6%88%91%E8%A1%A8%E8%BE%BE/" rel="tag">自我表达</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%B4%AA%E5%BF%83%E7%AE%97%E6%B3%95/" rel="tag">贪心算法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%9D%A2%E8%AF%95/" rel="tag">面试</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Apollo/" style="font-size: 10px;">Apollo</a> <a href="/tags/HyperLogLog/" style="font-size: 10px;">HyperLogLog</a> <a href="/tags/Linux/" style="font-size: 14.29px;">Linux</a> <a href="/tags/Mac/" style="font-size: 10px;">Mac</a> <a href="/tags/MySQL/" style="font-size: 11.43px;">MySQL</a> <a href="/tags/PHP/" style="font-size: 20px;">PHP</a> <a href="/tags/PHP7/" style="font-size: 17.14px;">PHP7</a> <a href="/tags/PHP7%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/" style="font-size: 10px;">PHP7垃圾回收</a> <a href="/tags/PHP%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F/" style="font-size: 10px;">PHP原型模式</a> <a href="/tags/PHP%E6%BA%90%E7%A0%81/" style="font-size: 18.57px;">PHP源码</a> <a href="/tags/PHP%E7%B2%BE%E5%BA%A6/" style="font-size: 10px;">PHP精度</a> <a href="/tags/PHP%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" style="font-size: 11.43px;">PHP设计模式</a> <a href="/tags/Redis/" style="font-size: 10px;">Redis</a> <a href="/tags/ascii/" style="font-size: 10px;">ascii</a> <a href="/tags/blockchain/" style="font-size: 10px;">blockchain</a> <a href="/tags/brew/" style="font-size: 10px;">brew</a> <a href="/tags/cli/" style="font-size: 10px;">cli</a> <a href="/tags/devops/" style="font-size: 10px;">devops</a> <a href="/tags/docker/" style="font-size: 17.14px;">docker</a> <a href="/tags/docker-network/" style="font-size: 10px;">docker network</a> <a href="/tags/docker%E5%AE%89%E5%85%A8/" style="font-size: 10px;">docker安全</a> <a href="/tags/http/" style="font-size: 12.86px;">http</a> <a href="/tags/json/" style="font-size: 10px;">json</a> <a href="/tags/libnetwork/" style="font-size: 10px;">libnetwork</a> <a href="/tags/nginx/" style="font-size: 12.86px;">nginx</a> <a href="/tags/shell/" style="font-size: 10px;">shell</a> <a href="/tags/tcp/" style="font-size: 11.43px;">tcp</a> <a href="/tags/token/" style="font-size: 10px;">token</a> <a href="/tags/ulimit/" style="font-size: 10px;">ulimit</a> <a href="/tags/unicode/" style="font-size: 10px;">unicode</a> <a href="/tags/utf-8/" style="font-size: 10px;">utf-8</a> <a href="/tags/%E4%BB%A5%E5%A4%AA%E5%9D%8A/" style="font-size: 15.71px;">以太坊</a> <a href="/tags/%E5%81%A5%E5%BA%B7/" style="font-size: 10px;">健康</a> <a href="/tags/%E5%81%A5%E8%BA%AB/" style="font-size: 10px;">健身</a> <a href="/tags/%E5%86%85%E5%AD%98/" style="font-size: 10px;">内存</a> <a href="/tags/%E5%87%8F%E8%82%A5/" style="font-size: 10px;">减肥</a> <a href="/tags/%E5%87%BA%E5%9B%BD%E6%B8%B8/" style="font-size: 12.86px;">出国游</a> <a href="/tags/%E5%8C%BA%E5%9D%97%E9%93%BE/" style="font-size: 14.29px;">区块链</a> <a href="/tags/%E5%9B%A2%E5%BB%BA/" style="font-size: 12.86px;">团建</a> <a href="/tags/%E5%AE%B9%E5%99%A8/" style="font-size: 12.86px;">容器</a> <a href="/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/" style="font-size: 10px;">微服务</a> <a href="/tags/%E6%88%90%E9%95%BF%E8%BF%9B%E9%98%B6/" style="font-size: 11.43px;">成长进阶</a> <a href="/tags/%E6%99%AE%E5%90%89%E5%B2%9B/" style="font-size: 12.86px;">普吉岛</a> <a href="/tags/%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6/" style="font-size: 11.43px;">智能合约</a> <a href="/tags/%E6%AF%94%E7%89%B9%E5%B8%81/" style="font-size: 10px;">比特币</a> <a href="/tags/%E6%B3%B0%E5%9B%BD/" style="font-size: 12.86px;">泰国</a> <a href="/tags/%E7%A7%81%E6%9C%89%E9%93%BE/" style="font-size: 10px;">私有链</a> <a href="/tags/%E7%A8%8B%E5%BA%8F%E5%91%98/" style="font-size: 11.43px;">程序员</a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size: 10px;">算法</a> <a href="/tags/%E7%BB%9F%E8%AE%A1/" style="font-size: 10px;">统计</a> <a href="/tags/%E7%BC%96%E7%A0%81/" style="font-size: 10px;">编码</a> <a href="/tags/%E8%87%AA%E6%88%91%E8%A1%A8%E8%BE%BE/" style="font-size: 10px;">自我表达</a> <a href="/tags/%E8%B4%AA%E5%BF%83%E7%AE%97%E6%B3%95/" style="font-size: 10px;">贪心算法</a> <a href="/tags/%E9%9D%A2%E8%AF%95/" style="font-size: 11.43px;">面试</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/03/">March 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">October 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">June 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">May 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">December 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">October 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">November 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">September 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">June 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">February 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">October 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">March 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">August 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2022/03/13/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2021/10/04/docker%E7%89%88%E6%9C%ACmysql5-7%E5%8F%8A%E4%BB%A5%E4%B8%8A%E7%89%88%E6%9C%AC-only-full-group-by%E6%8A%A5%E9%94%99%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/">Docker版本Mysql5.7及以上版本 ONLY_FULL_GROUP_BY报错的解决方法</a>
          </li>
        
          <li>
            <a href="/2021/06/16/contract-eth/">【以太坊】公链上的合约</a>
          </li>
        
          <li>
            <a href="/2021/06/07/approve-transfer/">【以太坊】实现智能合约授权与余额转账</a>
          </li>
        
          <li>
            <a href="/2021/05/30/solidity-keyword/">【以太坊】实现ERC20代币智能合约</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2022 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>